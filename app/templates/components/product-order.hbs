<div class="card product-card m-2">
  <div class="card-header">{{@product.name}}</div>
  <div class="card-body d-flex">
    <div class="product-card-image">
      <img class="w-100" src={{@product.imageUrl}} alt={{@product.name}}>
    </div>
    <BsForm
      class="pl-2 flex-grow-1 d-flex flex-column"
      @model={{this}}
      @onSubmit={{action this.setOrder this.ordered}}
      as |form|
    >
      <div class="d-flex mb-2 text-muted small">
        <span class="flex-grow-1">{{currency @product.price}}</span>
        {{max 0 (sub @product.available this.ordered)}} available
      </div>
      <form.group class="d-flex flex-grow-1">
        <label class="col-form-label">Ordered:</label>
        <input
          type="number" 
          class="form-control product-quantity-input ml-2"
          min="0"
          max={{@product.available}}
          value={{this.ordered}}
          oninput={{action (mut this.ordered) value="target.value"}}
        >
        <div class="flex-grow-1 form-text text-right">
          {{currency (mult @product.price this.ordered)}}
        </div>
      </form.group>
      {{#if (not (eq this.ordered @product.ordered))}}
        <div class="text-right">
          <BsButton
            @buttonType="cancel"
            @disabled={{form.isSubmitting}}
            @onClick={{action (mut this.ordered) @product.ordered}}
          >
            Reset
          </BsButton>
          <BsButton
            @buttonType="submit"
            @type="primary"
            @disabled={{form.isSubmitting}}
          >
            Save
            {{#if form.isSubmitting}}
              {{fa-icon "spinner" spin=true}}
            {{/if}}
          </BsButton>
        </div>
      {{/if}}
    </BsForm>
  </div>
</div>
